{% extends "base.html" %}

{% block title %}Edit Fixture - {{ task.team }} vs {{ fixture.opposition_name }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">
            <i class="fas fa-edit text-danger"></i>
            Edit Fixture: {{ task.team }} vs {{ fixture.opposition_name or 'TBC' }}
        </h1>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Fixture Details</h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="team_name" class="form-label">Team</label>
                                <input type="text" class="form-control" id="team_name" value="{{ task.team }}" readonly>
                                <small class="form-text text-muted">Team cannot be changed</small>
                            </div>

                            <div class="mb-3">
                                <label for="opposition_name" class="form-label">Opposition</label>
                                <input type="text" class="form-control" id="opposition_name" name="opposition_name"
                                       value="{{ fixture.opposition_name or '' }}" required>
                            </div>

                            <div class="mb-3">
                                <label for="home_away" class="form-label">Home/Away</label>
                                <input type="text" class="form-control" id="home_away"
                                       value="{{ fixture.home_away }}" readonly>
                                <small class="form-text text-muted">Home/Away cannot be changed</small>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="pitch_name" class="form-label">Pitch</label>
                                <select class="form-control" id="pitch_name" name="pitch_name">
                                    <option value="">Select a pitch...</option>
                                    {% for pitch in pitches %}
                                    <option value="{{ pitch.name }}"
                                            {% if fixture.pitch and fixture.pitch.name == pitch.name %}selected{% endif %}>
                                        {{ pitch.name }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="kickoff_time" class="form-label">Kick-off Time</label>
                                <input type="text" class="form-control" id="kickoff_time" name="kickoff_time"
                                       value="{{ fixture.kickoff_time_text or '' }}"
                                       placeholder="e.g. 10:30">
                            </div>

                            <div class="mb-3">
                                <label for="fixture_date" class="form-label">Date</label>
                                <input type="text" class="form-control" id="fixture_date"
                                       value="{{ fixture.fixture_date.strftime('%d/%m/%Y') if fixture.fixture_date else 'TBC' }}" readonly>
                                <small class="form-text text-muted">Date cannot be changed from uploaded fixtures</small>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-12">
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                            <a href="{{ url_for('view_task', task_id=task.id) }}" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancel
                            </a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">Edit Notes</h6>
            </div>
            <div class="card-body">
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <strong>What you can edit:</strong>
                    <ul class="mb-0 mt-2">
                        <li>Opposition name</li>
                        <li>Pitch assignment</li>
                        <li>Kick-off time</li>
                    </ul>
                </div>

                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Note:</strong> Changes will affect any emails that are regenerated for this fixture.
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}